import{q,I as G,f as v,J as O,aZ as Pe,_ as V,b as p,S as Te,l as Ae,j as o,K as $,k as D,p as H,M as Ee,o as S,aV as te,a_ as Se,a$ as Me,aW as re,F as pe,a0 as fe,a1 as me,a5 as Le,a6 as P,U as ge,a2 as ze,ah as ke,aX as Ne}from"./index-CeIe-P89.js";import{t as De,k as Ie,w as se,x as Be,y as _e,P as We,z as Ue,A as Fe,E as qe,F as Ge}from"./App-BhD2WLvn.js";import{C as Oe}from"./CircularProgress-CAlegvK9.js";function Ve(e){return q("MuiCollapse",e)}G("MuiCollapse",["root","horizontal","vertical","entered","hidden","wrapper","wrapperInner"]);const He=["addEndListener","children","className","collapsedSize","component","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","orientation","style","timeout","TransitionComponent"],Xe=e=>{const{orientation:t,classes:r}=e,n={root:["root",`${t}`],entered:["entered"],hidden:["hidden"],wrapper:["wrapper",`${t}`],wrapperInner:["wrapperInner",`${t}`]};return H(n,Ve,r)},Ke=$("div",{name:"MuiCollapse",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,t[r.orientation],r.state==="entered"&&t.entered,r.state==="exited"&&!r.in&&r.collapsedSize==="0px"&&t.hidden]}})(({theme:e,ownerState:t})=>p({height:0,overflow:"hidden",transition:e.transitions.create("height")},t.orientation==="horizontal"&&{height:"auto",width:0,transition:e.transitions.create("width")},t.state==="entered"&&p({height:"auto",overflow:"visible"},t.orientation==="horizontal"&&{width:"auto"}),t.state==="exited"&&!t.in&&t.collapsedSize==="0px"&&{visibility:"hidden"})),Je=$("div",{name:"MuiCollapse",slot:"Wrapper",overridesResolver:(e,t)=>t.wrapper})(({ownerState:e})=>p({display:"flex",width:"100%"},e.orientation==="horizontal"&&{width:"auto",height:"100%"})),Ze=$("div",{name:"MuiCollapse",slot:"WrapperInner",overridesResolver:(e,t)=>t.wrapperInner})(({ownerState:e})=>p({width:"100%"},e.orientation==="horizontal"&&{width:"auto",height:"100%"})),xe=v.forwardRef(function(t,r){const n=O({props:t,name:"MuiCollapse"}),{addEndListener:c,children:g,className:f,collapsedSize:l="0px",component:s,easing:x,in:d,onEnter:u,onEntered:m,onEntering:C,onExit:b,onExited:i,onExiting:h,orientation:y="vertical",style:w,timeout:j=Pe.standard,TransitionComponent:B=De}=n,Z=V(n,He),L=p({},n,{orientation:y,collapsedSize:l}),T=Xe(L),_=Ie(),Q=Te(),A=v.useRef(null),W=v.useRef(),z=typeof l=="number"?`${l}px`:l,M=y==="horizontal",U=M?"width":"height",X=v.useRef(null),be=Ae(r,X),k=a=>R=>{if(a){const E=X.current;R===void 0?a(E):a(E,R)}},Y=()=>A.current?A.current[M?"clientWidth":"clientHeight"]:0,ve=k((a,R)=>{A.current&&M&&(A.current.style.position="absolute"),a.style[U]=z,u&&u(a,R)}),Ce=k((a,R)=>{const E=Y();A.current&&M&&(A.current.style.position="");const{duration:F,easing:K}=se({style:w,timeout:j,easing:x},{mode:"enter"});if(j==="auto"){const ne=_.transitions.getAutoHeightDuration(E);a.style.transitionDuration=`${ne}ms`,W.current=ne}else a.style.transitionDuration=typeof F=="string"?F:`${F}ms`;a.style[U]=`${E}px`,a.style.transitionTimingFunction=K,C&&C(a,R)}),ye=k((a,R)=>{a.style[U]="auto",m&&m(a,R)}),Re=k(a=>{a.style[U]=`${Y()}px`,b&&b(a)}),$e=k(i),we=k(a=>{const R=Y(),{duration:E,easing:F}=se({style:w,timeout:j,easing:x},{mode:"exit"});if(j==="auto"){const K=_.transitions.getAutoHeightDuration(R);a.style.transitionDuration=`${K}ms`,W.current=K}else a.style.transitionDuration=typeof E=="string"?E:`${E}ms`;a.style[U]=z,a.style.transitionTimingFunction=F,h&&h(a)}),je=a=>{j==="auto"&&Q.start(W.current||0,a),c&&c(X.current,a)};return o.jsx(B,p({in:d,onEnter:ve,onEntered:ye,onEntering:Ce,onExit:Re,onExited:$e,onExiting:we,addEndListener:je,nodeRef:X,timeout:j==="auto"?null:j},Z,{children:(a,R)=>o.jsx(Ke,p({as:s,className:D(T.root,f,{entered:T.entered,exited:!d&&z==="0px"&&T.hidden}[a]),style:p({[M?"minWidth":"minHeight"]:z},w),ref:be},R,{ownerState:p({},L,{state:a}),children:o.jsx(Je,{ownerState:p({},L,{state:a}),className:T.wrapper,ref:A,children:o.jsx(Ze,{ownerState:p({},L,{state:a}),className:T.wrapperInner,children:g})})}))}))});xe.muiSupportAuto=!0;const he=v.createContext({});function Qe(e){return q("MuiAccordion",e)}const J=G("MuiAccordion",["root","rounded","expanded","disabled","gutters","region"]),Ye=["children","className","defaultExpanded","disabled","disableGutters","expanded","onChange","square","slots","slotProps","TransitionComponent","TransitionProps"],et=e=>{const{classes:t,square:r,expanded:n,disabled:c,disableGutters:g}=e;return H({root:["root",!r&&"rounded",n&&"expanded",c&&"disabled",!g&&"gutters"],region:["region"]},Qe,t)},tt=$(We,{name:"MuiAccordion",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[{[`& .${J.region}`]:t.region},t.root,!r.square&&t.rounded,!r.disableGutters&&t.gutters]}})(({theme:e})=>{const t={duration:e.transitions.duration.shortest};return{position:"relative",transition:e.transitions.create(["margin"],t),overflowAnchor:"none","&::before":{position:"absolute",left:0,top:-1,right:0,height:1,content:'""',opacity:1,backgroundColor:(e.vars||e).palette.divider,transition:e.transitions.create(["opacity","background-color"],t)},"&:first-of-type":{"&::before":{display:"none"}},[`&.${J.expanded}`]:{"&::before":{opacity:0},"&:first-of-type":{marginTop:0},"&:last-of-type":{marginBottom:0},"& + &":{"&::before":{display:"none"}}},[`&.${J.disabled}`]:{backgroundColor:(e.vars||e).palette.action.disabledBackground}}},({theme:e})=>({variants:[{props:t=>!t.square,style:{borderRadius:0,"&:first-of-type":{borderTopLeftRadius:(e.vars||e).shape.borderRadius,borderTopRightRadius:(e.vars||e).shape.borderRadius},"&:last-of-type":{borderBottomLeftRadius:(e.vars||e).shape.borderRadius,borderBottomRightRadius:(e.vars||e).shape.borderRadius,"@supports (-ms-ime-align: auto)":{borderBottomLeftRadius:0,borderBottomRightRadius:0}}}},{props:t=>!t.disableGutters,style:{[`&.${J.expanded}`]:{margin:"16px 0"}}}]})),St=v.forwardRef(function(t,r){const n=O({props:t,name:"MuiAccordion"}),{children:c,className:g,defaultExpanded:f=!1,disabled:l=!1,disableGutters:s=!1,expanded:x,onChange:d,square:u=!1,slots:m={},slotProps:C={},TransitionComponent:b,TransitionProps:i}=n,h=V(n,Ye),[y,w]=Be({controlled:x,default:f,name:"Accordion",state:"expanded"}),j=v.useCallback(M=>{w(!y),d&&d(M,!y)},[y,d,w]),[B,...Z]=v.Children.toArray(c),L=v.useMemo(()=>({expanded:y,disabled:l,disableGutters:s,toggle:j}),[y,l,s,j]),T=p({},n,{square:u,disabled:l,disableGutters:s,expanded:y}),_=et(T),Q=p({transition:b},m),A=p({transition:i},C),[W,z]=_e("transition",{elementType:xe,externalForwardedProps:{slots:Q,slotProps:A},ownerState:T});return o.jsxs(tt,p({className:D(_.root,g),ref:r,ownerState:T,square:u},h,{children:[o.jsx(he.Provider,{value:L,children:B}),o.jsx(W,p({in:y,timeout:"auto"},z,{children:o.jsx("div",{"aria-labelledby":B.props.id,id:B.props["aria-controls"],role:"region",className:_.region,children:Z})}))]}))});function rt(e){return q("MuiAccordionDetails",e)}G("MuiAccordionDetails",["root"]);const ot=["className"],nt=e=>{const{classes:t}=e;return H({root:["root"]},rt,t)},st=$("div",{name:"MuiAccordionDetails",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e})=>({padding:e.spacing(1,2,2)})),Mt=v.forwardRef(function(t,r){const n=O({props:t,name:"MuiAccordionDetails"}),{className:c}=n,g=V(n,ot),f=n,l=nt(f);return o.jsx(st,p({className:D(l.root,c),ref:r,ownerState:f},g))});function at(e){return q("MuiAccordionSummary",e)}const N=G("MuiAccordionSummary",["root","expanded","focusVisible","disabled","gutters","contentGutters","content","expandIconWrapper"]),it=["children","className","expandIcon","focusVisibleClassName","onClick"],lt=e=>{const{classes:t,expanded:r,disabled:n,disableGutters:c}=e;return H({root:["root",r&&"expanded",n&&"disabled",!c&&"gutters"],focusVisible:["focusVisible"],content:["content",r&&"expanded",!c&&"contentGutters"],expandIconWrapper:["expandIconWrapper",r&&"expanded"]},at,t)},ct=$(Ee,{name:"MuiAccordionSummary",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e})=>{const t={duration:e.transitions.duration.shortest};return{display:"flex",minHeight:48,padding:e.spacing(0,2),transition:e.transitions.create(["min-height","background-color"],t),[`&.${N.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`&.${N.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity},[`&:hover:not(.${N.disabled})`]:{cursor:"pointer"},variants:[{props:r=>!r.disableGutters,style:{[`&.${N.expanded}`]:{minHeight:64}}}]}}),dt=$("div",{name:"MuiAccordionSummary",slot:"Content",overridesResolver:(e,t)=>t.content})(({theme:e})=>({display:"flex",flexGrow:1,margin:"12px 0",variants:[{props:t=>!t.disableGutters,style:{transition:e.transitions.create(["margin"],{duration:e.transitions.duration.shortest}),[`&.${N.expanded}`]:{margin:"20px 0"}}}]})),ut=$("div",{name:"MuiAccordionSummary",slot:"ExpandIconWrapper",overridesResolver:(e,t)=>t.expandIconWrapper})(({theme:e})=>({display:"flex",color:(e.vars||e).palette.action.active,transform:"rotate(0deg)",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest}),[`&.${N.expanded}`]:{transform:"rotate(180deg)"}})),Lt=v.forwardRef(function(t,r){const n=O({props:t,name:"MuiAccordionSummary"}),{children:c,className:g,expandIcon:f,focusVisibleClassName:l,onClick:s}=n,x=V(n,it),{disabled:d=!1,disableGutters:u,expanded:m,toggle:C}=v.useContext(he),b=y=>{C&&C(y),s&&s(y)},i=p({},n,{expanded:m,disabled:d,disableGutters:u}),h=lt(i);return o.jsxs(ct,p({focusRipple:!1,disableRipple:!0,disabled:d,component:"div","aria-expanded":m,className:D(h.root,g),focusVisibleClassName:D(h.focusVisible,l),onClick:b,ref:r,ownerState:i},x,{children:[o.jsx(dt,{className:h.content,ownerState:i,children:c}),f&&o.jsx(ut,{className:h.expandIconWrapper,ownerState:i,children:f})]}))});function pt(e){return q("MuiLinearProgress",e)}G("MuiLinearProgress",["root","colorPrimary","colorSecondary","determinate","indeterminate","buffer","query","dashed","dashedColorPrimary","dashedColorSecondary","bar","barColorPrimary","barColorSecondary","bar1Indeterminate","bar1Determinate","bar1Buffer","bar2Indeterminate","bar2Buffer"]);const ft=["className","color","value","valueBuffer","variant"];let I=e=>e,ae,ie,le,ce,de,ue;const ee=4,mt=re(ae||(ae=I`
  0% {
    left: -35%;
    right: 100%;
  }

  60% {
    left: 100%;
    right: -90%;
  }

  100% {
    left: 100%;
    right: -90%;
  }
`)),gt=re(ie||(ie=I`
  0% {
    left: -200%;
    right: 100%;
  }

  60% {
    left: 107%;
    right: -8%;
  }

  100% {
    left: 107%;
    right: -8%;
  }
`)),xt=re(le||(le=I`
  0% {
    opacity: 1;
    background-position: 0 -23px;
  }

  60% {
    opacity: 0;
    background-position: 0 -23px;
  }

  100% {
    opacity: 1;
    background-position: -200px -23px;
  }
`)),ht=e=>{const{classes:t,variant:r,color:n}=e,c={root:["root",`color${S(n)}`,r],dashed:["dashed",`dashedColor${S(n)}`],bar1:["bar",`barColor${S(n)}`,(r==="indeterminate"||r==="query")&&"bar1Indeterminate",r==="determinate"&&"bar1Determinate",r==="buffer"&&"bar1Buffer"],bar2:["bar",r!=="buffer"&&`barColor${S(n)}`,r==="buffer"&&`color${S(n)}`,(r==="indeterminate"||r==="query")&&"bar2Indeterminate",r==="buffer"&&"bar2Buffer"]};return H(c,pt,t)},oe=(e,t)=>t==="inherit"?"currentColor":e.vars?e.vars.palette.LinearProgress[`${t}Bg`]:e.palette.mode==="light"?Se(e.palette[t].main,.62):Me(e.palette[t].main,.5),bt=$("span",{name:"MuiLinearProgress",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,t[`color${S(r.color)}`],t[r.variant]]}})(({ownerState:e,theme:t})=>p({position:"relative",overflow:"hidden",display:"block",height:4,zIndex:0,"@media print":{colorAdjust:"exact"},backgroundColor:oe(t,e.color)},e.color==="inherit"&&e.variant!=="buffer"&&{backgroundColor:"none","&::before":{content:'""',position:"absolute",left:0,top:0,right:0,bottom:0,backgroundColor:"currentColor",opacity:.3}},e.variant==="buffer"&&{backgroundColor:"transparent"},e.variant==="query"&&{transform:"rotate(180deg)"})),vt=$("span",{name:"MuiLinearProgress",slot:"Dashed",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.dashed,t[`dashedColor${S(r.color)}`]]}})(({ownerState:e,theme:t})=>{const r=oe(t,e.color);return p({position:"absolute",marginTop:0,height:"100%",width:"100%"},e.color==="inherit"&&{opacity:.3},{backgroundImage:`radial-gradient(${r} 0%, ${r} 16%, transparent 42%)`,backgroundSize:"10px 10px",backgroundPosition:"0 -23px"})},te(ce||(ce=I`
    animation: ${0} 3s infinite linear;
  `),xt)),Ct=$("span",{name:"MuiLinearProgress",slot:"Bar1",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.bar,t[`barColor${S(r.color)}`],(r.variant==="indeterminate"||r.variant==="query")&&t.bar1Indeterminate,r.variant==="determinate"&&t.bar1Determinate,r.variant==="buffer"&&t.bar1Buffer]}})(({ownerState:e,theme:t})=>p({width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left",backgroundColor:e.color==="inherit"?"currentColor":(t.vars||t).palette[e.color].main},e.variant==="determinate"&&{transition:`transform .${ee}s linear`},e.variant==="buffer"&&{zIndex:1,transition:`transform .${ee}s linear`}),({ownerState:e})=>(e.variant==="indeterminate"||e.variant==="query")&&te(de||(de=I`
      width: auto;
      animation: ${0} 2.1s cubic-bezier(0.65, 0.815, 0.735, 0.395) infinite;
    `),mt)),yt=$("span",{name:"MuiLinearProgress",slot:"Bar2",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.bar,t[`barColor${S(r.color)}`],(r.variant==="indeterminate"||r.variant==="query")&&t.bar2Indeterminate,r.variant==="buffer"&&t.bar2Buffer]}})(({ownerState:e,theme:t})=>p({width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left"},e.variant!=="buffer"&&{backgroundColor:e.color==="inherit"?"currentColor":(t.vars||t).palette[e.color].main},e.color==="inherit"&&{opacity:.3},e.variant==="buffer"&&{backgroundColor:oe(t,e.color),transition:`transform .${ee}s linear`}),({ownerState:e})=>(e.variant==="indeterminate"||e.variant==="query")&&te(ue||(ue=I`
      width: auto;
      animation: ${0} 2.1s cubic-bezier(0.165, 0.84, 0.44, 1) 1.15s infinite;
    `),gt)),Rt=v.forwardRef(function(t,r){const n=O({props:t,name:"MuiLinearProgress"}),{className:c,color:g="primary",value:f,valueBuffer:l,variant:s="indeterminate"}=n,x=V(n,ft),d=p({},n,{color:g,variant:s}),u=ht(d),m=Ue(),C={},b={bar1:{},bar2:{}};if((s==="determinate"||s==="buffer")&&f!==void 0){C["aria-valuenow"]=Math.round(f),C["aria-valuemin"]=0,C["aria-valuemax"]=100;let i=f-100;m&&(i=-i),b.bar1.transform=`translateX(${i}%)`}if(s==="buffer"&&l!==void 0){let i=(l||0)-100;m&&(i=-i),b.bar2.transform=`translateX(${i}%)`}return o.jsxs(bt,p({className:D(u.root,c),ownerState:d,role:"progressbar"},C,{ref:r},x,{children:[s==="buffer"?o.jsx(vt,{className:u.dashed,ownerState:d}):null,o.jsx(Ct,{className:u.bar1,ownerState:d,style:b.bar1}),s==="determinate"?null:o.jsx(yt,{className:u.bar2,ownerState:d,style:b.bar2})]}))}),$t=pe.forwardRef(({sx:e,color:t,...r},n)=>o.jsx(Rt,{color:t??"inherit",sx:{m:1,height:5,borderRadius:5,...e},ref:n,...r})),zt=pe.forwardRef(({sx:e,color:t,...r},n)=>o.jsx(Oe,{color:t??"inherit",sx:{m:1,...e},ref:n,...r})),kt=({routeId:e,seq:t,containerSx:r,showStopName:n=!1})=>{const{t:c}=fe(),g=me(),{db:{routeList:f,stopList:l}}=v.useContext(Le),s=Fe(`${e}/${t}`),{route:x,co:d,stops:u}=f[e],m=Object.values(u)[0][t],C=v.useMemo(()=>Object.values(f[e].stops).map(i=>l[i[i.length-1]].name).concat(f[e].dest),[f,e,l]),b=v.useMemo(()=>{let i=!1;return d[0]==="mtr"?i=u.mtr.indexOf(m)+1>=u.mtr.length:d.includes("lightRail")&&(i=u.lightRail.indexOf(m)+1>=u.lightRail.length),s===null?null:i&&s.length===0?c("終點站"):s.length>0&&s.every(h=>!h.eta)&&s[0].remark[g]?s[0].remark[g]:s.length===0||s.every(h=>!h.eta)?c("未有班次資料"):null},[s,d,u,m,c,g]);return s==null?o.jsx(P,{sx:r,children:o.jsx($t,{})}):o.jsxs(P,{sx:r,children:[n&&o.jsx(ge,{variant:"caption",children:l[m].name[g]}),b,s.length>0&&s.every(i=>i.eta)&&s.map((i,h)=>o.jsx(wt,{eta:i,routeDests:C,showCompany:d.length>1,route:x},`route-${h}`))]})},wt=({eta:{eta:e,remark:t,co:r,dest:n},routeDests:c,showCompany:g,route:f})=>{const{t:l}=fe(),s=me(),{etaFormat:x,platformMode:d}=v.useContext(ze),u=v.useMemo(()=>{if(r==="mtr")return!0;for(const w of c)if(w.en.toLowerCase()===n.en.toLowerCase()||w.zh===n.zh)return!1;return!0},[c,n,r]),m=Math.round((new Date(e).getTime()-new Date().getTime())/60/1e3),C=o.jsx(P,{component:"span",sx:x!=="exact"?{fontSize:"0.9em"}:{},children:e.slice(11,16)}),b=r==="mtr"||r==="lightRail";let i,h;b&&m<=1?(i=m===1?`${l("即將抵達")} `:`${l("正在離開")} `,h=!0):(i=m<1?" - ":`${m} `,h=!1);const y=o.jsxs(P,{component:"span",children:[o.jsx(P,{component:"span",sx:{...Pt,color:w=>w.palette.warning.main},fontSize:h?"0.9em":void 0,children:i}),!h&&o.jsx(P,{component:"span",sx:{fontSize:"0.8em"},children:l("分鐘")})]});return o.jsxs(ge,{variant:"subtitle1",sx:{justifyContent:"center"},children:[x==="diff"&&y,x==="exact"&&C,x==="mixed"&&o.jsxs(o.Fragment,{children:[C," ",y]}),!b&&o.jsx(o.Fragment,{children:" - "}),o.jsxs(P,{component:"span",sx:{fontSize:"0.8em",textOverflow:"ellipsis"},children:[g&&o.jsxs(o.Fragment,{children:[" ",l(r)]})," ",o.jsx(jt,{remark:t,co:r,language:s,route:f,platformMode:d}),b&&" ",!b&&o.jsx(o.Fragment,{children:" "}),u&&n[s]]})]})},jt=({remark:e,language:t,co:r,route:n,platformMode:c})=>{if(e===null)return"";if(!(r==="mtr"||r==="lightRail"))return e[t];const f=[];let l="",s="";return(e.en||e[t]).split(" - ").forEach((x,d)=>{const u=[...x.matchAll(/^Platform (\d+)$/g)??[]][0]||[];if(u.length===2&&u[1].length){l=ke(Number(u[1]),c)??u[1];return}const m=(/^▭+$/g.exec(x)??[])[0];if(m){s=m;return}f.push(e[t].split(" - ")[d])}),o.jsxs(o.Fragment,{children:[o.jsx(P,{component:"span",color:Ne([r],n,!0),sx:{marginX:.25},children:l}),o.jsxs(P,{component:"span",sx:{marginX:.25},children:[s.length===1&&o.jsx(qe,{}),s.length===2&&o.jsx(Ge,{})]}),f.map((x,d)=>o.jsx(P,{component:"span",sx:{marginX:.25},children:x},d))]})},Pt={fontWeight:"700",color:"#088bce"};export{St as A,zt as C,$t as L,kt as T,Lt as a,Mt as b};
